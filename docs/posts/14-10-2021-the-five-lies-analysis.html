<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>The Five Lies Analysis - Sergey Tselovalnikov</title><meta content="Empty" name="description"/><meta property="og:url" content="https://serce.me/posts/14-10-2021-the-five-lies-analysis"/><link rel="canonical" href="https://serce.me/posts/14-10-2021-the-five-lies-analysis"/><meta property="og:type" content="article"/><meta property="og:site_name" content="The Five Lies Analysis - Sergey Tselovalnikov"/><meta property="og:description" content="Empty"/><meta property="og:title" content="The Five Lies Analysis - Sergey Tselovalnikov"/><meta property="og:image" content="https://serce.meundefined"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@SerCeMan"/><meta name="twitter:title" content="The Five Lies Analysis - Sergey Tselovalnikov"/><meta name="twitter:description" content="Empty"/><meta name="twitter:image" content="https://serce.meundefined"/><meta property="article:published_time" content="2021-10-14"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/b36d29652127289e.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b36d29652127289e.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8aea71f50af9d276.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8aea71f50af9d276.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-70187573dbb2adba.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9d9bd6946354a189.js" defer=""></script><script src="/_next/static/chunks/105-7a67388502189cf8.js" defer=""></script><script src="/_next/static/chunks/675-25da51e9f406e7b5.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-a7d1e1bbffbcf525.js" defer=""></script><script src="/_next/static/vZVYDKMmC4lUxJF5StUtV/_buildManifest.js" defer=""></script><script src="/_next/static/vZVYDKMmC4lUxJF5StUtV/_ssgManifest.js" defer=""></script></head><body style="background-color:#f2f2f2" class="bg-white text-gray-900"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if(e){c.add(e|| '')}else{c.add('light');}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(t){}}();</script><header style="background-color:#f8f8f8" class="relative shadow-md"><div class="max-w-5xl px-8 py-1 mx-auto"><div class="flex items-center justify-between"><nav class="flex flow-row justify-between items-center w-full text-lg"><a style="font-family:Alegreya" class="text-gray-500 pr-6 py-4 float-left w-1/2 text-4xl" href="/">SerCe&#x27;s blog</a><div class="float-right"><div class="grid grid-cols-3 gap-12"><a class="text-gray-600 py-4" href="/">Home</a><a class="text-gray-600 py-4" href="/blog">Blog</a><a class="text-gray-600 py-4" href="/talks">Talks</a></div></div></nav></div></div></header><main><div><article class="container mx-auto mt-12 px-10 py-8 shadow-md bg-white max-w-5xl flex flex-col"><p class="self-start text-sm text-gray-500">14 October 2021</p><div class="asciiprose"><h1 class="text-gray-900">The Five Lies Analysis</h1><p>The Five Whys analysis is a popular root cause investigation technique
with a simple premise that is asking why five times can yield the
answer, which is the root cause. While doing so could be a helpful
exercise, blindly applying the technique often leads to a suboptimal
result. In this article, I’ll explore some of its tradeoffs with a
fictional story of an incident in production at
<a href="https://en.wikipedia.org/wiki/Acme_Corporation">Acme Corp</a>.</p>
<p><img src="/images/five-lies/crew.png" alt=""/></p>
<div class="quoteblock"><blockquote><div class="paragraph"><p>I’m sorry. The words made sense, but the sarcastic tone did not.</p></div></blockquote><div class="attribution">— <!-- -->Lana Kane</div></div>
<h2 id="meet-the-crew"><a class="anchor" href="#meet-the-crew"><span class="icon icon-link"></span></a>Meet the crew</h2>
<p>Let’s start by setting the scene. A team of engineers is working on a
new Acme News website. Suddenly, an incident occurs, which gets resolved
quickly. A lengthy investigation then follows the incident to understand
what happened and how similar issues can be prevented in the future.</p>
<p>The standard process of achieving this would be to write a postmortem,
which can outline the story and propose a set of action items. A
postmortem template can simplify the process by including all necessary
steps to identify the root cause and might suggest using an analysis,
for example, the five whys analysis. The question of who is ultimately
responsible for authoring the postmortem is tricky, and the answer
depends on many factors. Let’s take a look at what everyone on the team
would write if they were the author.</p>
<h3 id="meet-alice"><a class="anchor" href="#meet-alice"><span class="icon icon-link"></span></a>Meet Alice</h3>
<img alt="Alice" src="/images/five-lies/alice.png" width="300" height="300" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/>
<p>As we know, Alice is an on-call engineer. Her official title is SRE, and
her job involves a deep understanding of the service state based on the
available metrics. She has a solid understanding of service health
indicators and a good grasp of the monitoring infrastructure. When she
started the investigation, she noticed that the application was
overloaded due to high CPU usage. As recommended by the postmortem
template, she began the five whys analysis.</p>
<p>Five Whys analysis:</p>
<ul>
<li>
<p>Why were the users not able to open the website? Because the
application was overloaded, and it started returning errors.</p>
</li>
<li>
<p>Why was it overloaded? Because the CPU went to 100%, and the instances
didn’t have enough capacity to process the requests.</p>
</li>
<li>
<p>Why did the CPU usage jump so high? Because we didn’t notice it
earlier when it climbed to 90% and didn’t fix the issue in time.</p>
</li>
<li>
<p>Why did we not notice it? Because there were no alerts for 90% CPU
usage.</p>
</li>
<li>
<p>Why were there no alerts? Because the alerts were removed two years
ago after a migration to a new monitoring system.</p>
</li>
</ul>
<p>As the Five Whys analysis was completed, the root cause was
&quot;identified&quot;. The main action item in the postmortem was to
re-instantiate high utilisation - 90% CPU alerts to catch similar
situations earlier and mitigate the issue before users are effect. Now
that all of the questions are answered, and the lessons are learned,
Alice is off to another incident.</p>
<h3 id="meet-bob"><a class="anchor" href="#meet-bob"><span class="icon icon-link"></span></a>Meet Bob</h3>
<img alt="Bob" src="/images/five-lies/bob.png" width="300" height="300" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/>
<p>Bob is the backend engineer who implemented the feature in the first
place and flipped the flag. He has the most context around the change,
so it would make sense for Bob to write a postmortem. Bob can use the
Five Whys analysis to complete the postmortem and understand how to roll
out all future changes smoother.</p>
<p>Five Whys analysis:</p>
<ul>
<li>
<p>Why were the users not able to open the website? Because the
application was overloaded.</p>
</li>
<li>
<p>Why was it overloaded? Because CPU jumped to 100%.</p>
</li>
<li>
<p>Why did it jump? Because the application went into an infinite GC
loop.</p>
</li>
<li>
<p>Why did GC start consuming all of the CPU? Because the application ran
out of heap memory.</p>
</li>
<li>
<p>Why did it run out of heap memory? Because a new request-level cache
was added with unlimited size.</p>
</li>
</ul>
<p>The new feature that Bob implemented enabled users to see article
recommendations on the Acme News website. To reduce the load to the
recommendation service, Bob added a cache. However, Bob forgot to add a
maximum size parameter. Bob then started thinking about how this could
be prevented in the future. He decided to change the Cache interface to
ensure that max size always has to be provided. This task was added as
the main action item to the postmortem.</p>
<h3 id="meet-charlie"><a class="anchor" href="#meet-charlie"><span class="icon icon-link"></span></a>Meet Charlie</h3>
<img alt="Charlie" src="/images/five-lies/charlie.png" width="300" height="300" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/>
<p>Charlie is a frontend engineer who implemented the feature on the
frontend side and is responsible for Acme Corp News overall look.
Charlie is also a product owner of the new Acme Corp Recommendations ™,
who cares a lot about the product’s availability, so it might make sense
for her to start a postmortem.</p>
<p>Five Whys analysis:</p>
<ul>
<li>
<p>Why were the users not able to open the website? Because the
application was overloaded.</p>
</li>
<li>
<p>Why was it overloaded? Because there was an influx of requests that
caused high CPU usage.</p>
</li>
<li>
<p>Why was there an influx? Because the users started sending a lot of
requests.</p>
</li>
<li>
<p>Why did they do this? Because each request was retried up to 10 times.</p>
</li>
<li>
<p>Why were there so many retries at the same time? Because there was no
exponential backoff.</p>
</li>
</ul>
<p>Charlie’s mental model of the application is primarily based around the
request flows. When looking at the application logs, she noticed many
retries from the same set of users. When looking at the code that
fetches the recommendations, she saw that all of the requests were
retried immediately without any exponential backoff or jitter. Hence,
she put it as an action item with the plan to implement it by Friday.</p>
<h3 id="meet-dave"><a class="anchor" href="#meet-dave"><span class="icon icon-link"></span></a>Meet Dave</h3>
<img alt="Dave" src="/images/five-lies/dave.png" width="300" height="300" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/>
<p>Dave is an engineer on the cloud infrastructure team, and he is
responsible for the overall health of the Acme News Corp cluster. Dave
cares a lot about reliability, so he might volunteer to perform the
investigation and complete the postmortem.</p>
<p>Five Whys analysis:</p>
<ul>
<li>Why were the users not able to open the website? Because the
application was overloaded.</li>
<li>Why was it overloaded? Because the load on every instance increased
sharply.</li>
<li>Why was the load per instance so high? Because we didn’t have enough
instance capacity to distribute the load.</li>
<li>Why not? Because our autoscaling policies didn’t scale fast enough and
only added a few more instances.</li>
<li>Why? Because the autoscaling cooldown time was too large.</li>
</ul>
<p>For Dave, each task in the cluster is essentially a black box that can
handle a certain number of requests. For each type of task, Dave manages
policies that define how the applications can scale up or down. After
looking at the graphs, Dave notices that even though a few instances
joined the fleet when the load increased sharply, the cooldown prevented
autoscaling from bringing up even more tasks to handle the load. Dave
writes down a task to update autoscaling policies to allow for very
aggressive scale-ups to handle the load as the main action item.</p>
<h3 id="meet-erin"><a class="anchor" href="#meet-erin"><span class="icon icon-link"></span></a>Meet Erin</h3>
<img alt="Erin" src="/images/five-lies/erin.png" width="300" height="300" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/>
<p>Erin is an engineer on the core libraries team, and she is working on a
shared set of core libraries. When she first heard about the incident
and that it was related to the cache library, she volunteered to write a
postmortem as the owner who doesn’t shy away from responsibility.</p>
<p>Five Whys analysis:</p>
<ul>
<li>Why were the users not able to open the website? Because the
application was overloaded.</li>
<li>Why was it overloaded? Because it was out of memory</li>
<li>Why was the application out of memory? Because the cache took too much
memory.</li>
<li>Why did the cache take up that much memory? Because our cache
libraries are not optimised for memory usage.</li>
<li>Why is the cache library not optimised for memory usage? Because we
always valued throughput above memory usage.</li>
</ul>
<p>Erin wrote the original cache library. The library has been a great
success as it is incredibly optimised for Acme Corp’s use cases.
Nonetheless, so far, the focus was the throughput and not the memory
usage. After looking at the library from a different perspective, Erin
noticed a few opportunities to share the underlying data structures and
wrote down an action item to provide a version of the cache explicitly
optimised for memory usage.</p>
<h2 id="the-analysis"><a class="anchor" href="#the-analysis"><span class="icon icon-link"></span></a>The analysis</h2>
<p>Let’s zoom out and take a look at the results of the exercise. There are
five people and five different stories. The key takeaway here is the
results of the why the Five Whys analysis are not repeatable. The
outcome heavily depends on the angle at which the person performing the
analysis looks at the incident. Dave’s point of view on what happened is
very different to Charlie’s point of view as they work on very different
parts of the system day-to-day, which heavily influences the analysis.</p>
<p>But even looking at a single investigation, we can notice that the
number “five” itself is interesting. It’s catchy, it’s easy to remember,
but it unnecessarily limits the depth of the investigation. Maybe Alice
should’ve done some code archeology to figure out why the alerts were
removed after the migration. Bob could have dug deeper to collect some
of the heap dumps to understand the distribution of data in the cache.
Why stop at five if it makes sense to go further?</p>
<h2 id="the-root-cause"><a class="anchor" href="#the-root-cause"><span class="icon icon-link"></span></a>The root cause</h2>
<p>As we saw, the Five Whys analysis has downsides like any other approach.
Yet, it can be used successfully to dive deeper! So are these issues big
enough to invalidate the approach?</p>
<p>The real problem reveals itself when the technique becomes a part of a
template. Once it’s in the template, the shape of the analysis becomes
solidified. Whether it’s a part of an engineering <a href="https://www.atlassian.com/incident-management/postmortem/templates">postmortem
template</a>
or even a <a href="https://www.justice.act.gov.au/sites/default/files/2019-08/Root_Cause_Analysis_Template.pdf">government
worksheet</a> -
the template restricts the analysis by forcing its limits onto the
investigator. The downsides of the analysis become the downsides of the
postmortem.</p>
<p>Well, if not using five whys, then how would we find the root cause?
First, it’s important to understand that rarely there is such thing as a
root cause. Often there would be multiple causes that can be seen when
looking at the incident from different angles.</p>
<p>Second, and more importantly, it’s not about finding the root cause at
all. It’s about getting an inside out understanding of what happened —
and then, based on this understanding, defining what actions can be
taken to ensure that the incident doesn’t repeat in the future. Often,
these action items can be very distant from the root cause. For
instance, maybe Acme News could restrict the blast radius and ensure
that the page loads even if recommendations are not available. These
mitigations might not always come up when searching for a root cause.
This poses a question - if not the Five Whys analysis, then what should
be in the template? It can’t be empty after all!</p>
<p>Before looking for a replacement, it’s important to understand that the
template should encourage building an understanding and a detailed story
rather than searching for a root cause. In <a href="https://www.kitchensoap.com/2014/11/14/the-infinite-hows-or-the-dangers-of-the-five-whys/">The Infinite
Hows</a>,
John Allspaw highlights that &quot;Learning is the goal. Any prevention
depends on that learning.&quot; and proposes using <a href="http://www.kitchensoap.com/wp-content/uploads/2014/09/Velocity2014-PM-Fac-Handout-Debrief.pdf">Debriefing Facilitation
Prompts</a>
from <em>The Field Guide To Understanding Human Error</em>, by Sidney Dekker.</p>
<p>Having the prompts could be a great starting point as it asks you to
take a look at the system from multiple angles and understand how each
individual part of the system behaved during the incident. Moreover, the
approach could further be expanded with the questions from the
environment - the questions that can help build the story and facilitate
learning. There could even be different prompts for different components
that were affected. If Alice or Bob, or any other member of the crew
were to use the prompts, they would immediately have to consider how the
system behaved from multiple angles giving the investigation the
necessary depth.</p>
<h2 id="conclusion"><a class="anchor" href="#conclusion"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>Five Whys analysis is a useful technique that is easy to remember and a
helpful reminder to always look deeper. However, using it directly would
only yield a cause, not the root cause, as rarely there is such thing as
the root cause. The approach could still be used to deepen the scope of
searching for action items. Still, structuring this tool into a template
as the primary driver of a root cause analysis can cause more harm than
good.</p>
<p>Instead, the template could facilitate learning and help build a story
by asking questions that can help understand the whole story deeply.
Then, a comprehensive list of action items can stem from the story
preventing not only incidents with a similar &quot;root cause&quot; but a whole
class of failures.</p>
<h2 id="thank-you-to"><a class="anchor" href="#thank-you-to"><span class="icon icon-link"></span></a>Thank you to</h2>
<ul>
<li><a href="https://twitter.com/ptuls">Paul Tune</a> for reviewing the article.</li>
<li>You for reading the article.</li>
</ul>
<h2 id="discuss-on"><a class="anchor" href="#discuss-on"><span class="icon icon-link"></span></a>Discuss on</h2>
<ul>
<li><a href="https://twitter.com/SerCeMan/status/1448641518370103303">Twitter</a></li>
</ul></div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    img: \"img\",\n    h2: \"h2\",\n    span: \"span\",\n    h3: \"h3\",\n    ul: \"ul\",\n    li: \"li\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {Quote, Image} = _components;\n  if (!Image) _missingMdxReference(\"Image\", true);\n  if (!Quote) _missingMdxReference(\"Quote\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"The Five Whys analysis is a popular root cause investigation technique\\nwith a simple premise that is asking why five times can yield the\\nanswer, which is the root cause. While doing so could be a helpful\\nexercise, blindly applying the technique often leads to a suboptimal\\nresult. In this article, I’ll explore some of its tradeoffs with a\\nfictional story of an incident in production at\\n\", _jsx(_components.a, {\n        href: \"https://en.wikipedia.org/wiki/Acme_Corporation\",\n        children: \"Acme Corp\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/images/five-lies/crew.png\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(Quote, {\n      quote: \"I’m sorry. The words made sense, but the sarcastic tone did not.\",\n      attribution: \"Lana Kane\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"meet-the-crew\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-the-crew\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet the crew\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let’s start by setting the scene. A team of engineers is working on a\\nnew Acme News website. Suddenly, an incident occurs, which gets resolved\\nquickly. A lengthy investigation then follows the incident to understand\\nwhat happened and how similar issues can be prevented in the future.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The standard process of achieving this would be to write a postmortem,\\nwhich can outline the story and propose a set of action items. A\\npostmortem template can simplify the process by including all necessary\\nsteps to identify the root cause and might suggest using an analysis,\\nfor example, the five whys analysis. The question of who is ultimately\\nresponsible for authoring the postmortem is tricky, and the answer\\ndepends on many factors. Let’s take a look at what everyone on the team\\nwould write if they were the author.\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"meet-alice\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-alice\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet Alice\"]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/images/five-lies/alice.png\",\n      alt: \"Alice\",\n      height: \"300\",\n      width: \"300\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As we know, Alice is an on-call engineer. Her official title is SRE, and\\nher job involves a deep understanding of the service state based on the\\navailable metrics. She has a solid understanding of service health\\nindicators and a good grasp of the monitoring infrastructure. When she\\nstarted the investigation, she noticed that the application was\\noverloaded due to high CPU usage. As recommended by the postmortem\\ntemplate, she began the five whys analysis.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why were the users not able to open the website? Because the\\napplication was overloaded, and it started returning errors.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why was it overloaded? Because the CPU went to 100%, and the instances\\ndidn’t have enough capacity to process the requests.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did the CPU usage jump so high? Because we didn’t notice it\\nearlier when it climbed to 90% and didn’t fix the issue in time.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did we not notice it? Because there were no alerts for 90% CPU\\nusage.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why were there no alerts? Because the alerts were removed two years\\nago after a migration to a new monitoring system.\"\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As the Five Whys analysis was completed, the root cause was\\n\\\"identified\\\". The main action item in the postmortem was to\\nre-instantiate high utilisation - 90% CPU alerts to catch similar\\nsituations earlier and mitigate the issue before users are effect. Now\\nthat all of the questions are answered, and the lessons are learned,\\nAlice is off to another incident.\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"meet-bob\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-bob\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet Bob\"]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/images/five-lies/bob.png\",\n      alt: \"Bob\",\n      height: \"300\",\n      width: \"300\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Bob is the backend engineer who implemented the feature in the first\\nplace and flipped the flag. He has the most context around the change,\\nso it would make sense for Bob to write a postmortem. Bob can use the\\nFive Whys analysis to complete the postmortem and understand how to roll\\nout all future changes smoother.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why were the users not able to open the website? Because the\\napplication was overloaded.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why was it overloaded? Because CPU jumped to 100%.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did it jump? Because the application went into an infinite GC\\nloop.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did GC start consuming all of the CPU? Because the application ran\\nout of heap memory.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did it run out of heap memory? Because a new request-level cache\\nwas added with unlimited size.\"\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The new feature that Bob implemented enabled users to see article\\nrecommendations on the Acme News website. To reduce the load to the\\nrecommendation service, Bob added a cache. However, Bob forgot to add a\\nmaximum size parameter. Bob then started thinking about how this could\\nbe prevented in the future. He decided to change the Cache interface to\\nensure that max size always has to be provided. This task was added as\\nthe main action item to the postmortem.\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"meet-charlie\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-charlie\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet Charlie\"]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/images/five-lies/charlie.png\",\n      alt: \"Charlie\",\n      height: \"300\",\n      width: \"300\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Charlie is a frontend engineer who implemented the feature on the\\nfrontend side and is responsible for Acme Corp News overall look.\\nCharlie is also a product owner of the new Acme Corp Recommendations ™,\\nwho cares a lot about the product’s availability, so it might make sense\\nfor her to start a postmortem.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why were the users not able to open the website? Because the\\napplication was overloaded.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why was it overloaded? Because there was an influx of requests that\\ncaused high CPU usage.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why was there an influx? Because the users started sending a lot of\\nrequests.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why did they do this? Because each request was retried up to 10 times.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"Why were there so many retries at the same time? Because there was no\\nexponential backoff.\"\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Charlie’s mental model of the application is primarily based around the\\nrequest flows. When looking at the application logs, she noticed many\\nretries from the same set of users. When looking at the code that\\nfetches the recommendations, she saw that all of the requests were\\nretried immediately without any exponential backoff or jitter. Hence,\\nshe put it as an action item with the plan to implement it by Friday.\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"meet-dave\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-dave\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet Dave\"]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/images/five-lies/dave.png\",\n      alt: \"Dave\",\n      height: \"300\",\n      width: \"300\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Dave is an engineer on the cloud infrastructure team, and he is\\nresponsible for the overall health of the Acme News Corp cluster. Dave\\ncares a lot about reliability, so he might volunteer to perform the\\ninvestigation and complete the postmortem.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Why were the users not able to open the website? Because the\\napplication was overloaded.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why was it overloaded? Because the load on every instance increased\\nsharply.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why was the load per instance so high? Because we didn’t have enough\\ninstance capacity to distribute the load.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why not? Because our autoscaling policies didn’t scale fast enough and\\nonly added a few more instances.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why? Because the autoscaling cooldown time was too large.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For Dave, each task in the cluster is essentially a black box that can\\nhandle a certain number of requests. For each type of task, Dave manages\\npolicies that define how the applications can scale up or down. After\\nlooking at the graphs, Dave notices that even though a few instances\\njoined the fleet when the load increased sharply, the cooldown prevented\\nautoscaling from bringing up even more tasks to handle the load. Dave\\nwrites down a task to update autoscaling policies to allow for very\\naggressive scale-ups to handle the load as the main action item.\"\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"meet-erin\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#meet-erin\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Meet Erin\"]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/images/five-lies/erin.png\",\n      alt: \"Erin\",\n      height: \"300\",\n      width: \"300\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Erin is an engineer on the core libraries team, and she is working on a\\nshared set of core libraries. When she first heard about the incident\\nand that it was related to the cache library, she volunteered to write a\\npostmortem as the owner who doesn’t shy away from responsibility.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Why were the users not able to open the website? Because the\\napplication was overloaded.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why was it overloaded? Because it was out of memory\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why was the application out of memory? Because the cache took too much\\nmemory.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why did the cache take up that much memory? Because our cache\\nlibraries are not optimised for memory usage.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Why is the cache library not optimised for memory usage? Because we\\nalways valued throughput above memory usage.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Erin wrote the original cache library. The library has been a great\\nsuccess as it is incredibly optimised for Acme Corp’s use cases.\\nNonetheless, so far, the focus was the throughput and not the memory\\nusage. After looking at the library from a different perspective, Erin\\nnoticed a few opportunities to share the underlying data structures and\\nwrote down an action item to provide a version of the cache explicitly\\noptimised for memory usage.\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"the-analysis\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#the-analysis\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"The analysis\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let’s zoom out and take a look at the results of the exercise. There are\\nfive people and five different stories. The key takeaway here is the\\nresults of the why the Five Whys analysis are not repeatable. The\\noutcome heavily depends on the angle at which the person performing the\\nanalysis looks at the incident. Dave’s point of view on what happened is\\nvery different to Charlie’s point of view as they work on very different\\nparts of the system day-to-day, which heavily influences the analysis.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"But even looking at a single investigation, we can notice that the\\nnumber “five” itself is interesting. It’s catchy, it’s easy to remember,\\nbut it unnecessarily limits the depth of the investigation. Maybe Alice\\nshould’ve done some code archeology to figure out why the alerts were\\nremoved after the migration. Bob could have dug deeper to collect some\\nof the heap dumps to understand the distribution of data in the cache.\\nWhy stop at five if it makes sense to go further?\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"the-root-cause\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#the-root-cause\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"The root cause\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"As we saw, the Five Whys analysis has downsides like any other approach.\\nYet, it can be used successfully to dive deeper! So are these issues big\\nenough to invalidate the approach?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The real problem reveals itself when the technique becomes a part of a\\ntemplate. Once it’s in the template, the shape of the analysis becomes\\nsolidified. Whether it’s a part of an engineering \", _jsx(_components.a, {\n        href: \"https://www.atlassian.com/incident-management/postmortem/templates\",\n        children: \"postmortem\\ntemplate\"\n      }), \"\\nor even a \", _jsx(_components.a, {\n        href: \"https://www.justice.act.gov.au/sites/default/files/2019-08/Root_Cause_Analysis_Template.pdf\",\n        children: \"government\\nworksheet\"\n      }), \" -\\nthe template restricts the analysis by forcing its limits onto the\\ninvestigator. The downsides of the analysis become the downsides of the\\npostmortem.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Well, if not using five whys, then how would we find the root cause?\\nFirst, it’s important to understand that rarely there is such thing as a\\nroot cause. Often there would be multiple causes that can be seen when\\nlooking at the incident from different angles.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Second, and more importantly, it’s not about finding the root cause at\\nall. It’s about getting an inside out understanding of what happened —\\nand then, based on this understanding, defining what actions can be\\ntaken to ensure that the incident doesn’t repeat in the future. Often,\\nthese action items can be very distant from the root cause. For\\ninstance, maybe Acme News could restrict the blast radius and ensure\\nthat the page loads even if recommendations are not available. These\\nmitigations might not always come up when searching for a root cause.\\nThis poses a question - if not the Five Whys analysis, then what should\\nbe in the template? It can’t be empty after all!\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Before looking for a replacement, it’s important to understand that the\\ntemplate should encourage building an understanding and a detailed story\\nrather than searching for a root cause. In \", _jsx(_components.a, {\n        href: \"https://www.kitchensoap.com/2014/11/14/the-infinite-hows-or-the-dangers-of-the-five-whys/\",\n        children: \"The Infinite\\nHows\"\n      }), \",\\nJohn Allspaw highlights that \\\"Learning is the goal. Any prevention\\ndepends on that learning.\\\" and proposes using \", _jsx(_components.a, {\n        href: \"http://www.kitchensoap.com/wp-content/uploads/2014/09/Velocity2014-PM-Fac-Handout-Debrief.pdf\",\n        children: \"Debriefing Facilitation\\nPrompts\"\n      }), \"\\nfrom \", _jsx(_components.em, {\n        children: \"The Field Guide To Understanding Human Error\"\n      }), \", by Sidney Dekker.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Having the prompts could be a great starting point as it asks you to\\ntake a look at the system from multiple angles and understand how each\\nindividual part of the system behaved during the incident. Moreover, the\\napproach could further be expanded with the questions from the\\nenvironment - the questions that can help build the story and facilitate\\nlearning. There could even be different prompts for different components\\nthat were affected. If Alice or Bob, or any other member of the crew\\nwere to use the prompts, they would immediately have to consider how the\\nsystem behaved from multiple angles giving the investigation the\\nnecessary depth.\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"conclusion\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#conclusion\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Conclusion\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Five Whys analysis is a useful technique that is easy to remember and a\\nhelpful reminder to always look deeper. However, using it directly would\\nonly yield a cause, not the root cause, as rarely there is such thing as\\nthe root cause. The approach could still be used to deepen the scope of\\nsearching for action items. Still, structuring this tool into a template\\nas the primary driver of a root cause analysis can cause more harm than\\ngood.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Instead, the template could facilitate learning and help build a story\\nby asking questions that can help understand the whole story deeply.\\nThen, a comprehensive list of action items can stem from the story\\npreventing not only incidents with a similar \\\"root cause\\\" but a whole\\nclass of failures.\"\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"thank-you-to\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#thank-you-to\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Thank you to\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://twitter.com/ptuls\",\n          children: \"Paul Tune\"\n        }), \" for reviewing the article.\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"You for reading the article.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"discuss-on\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#discuss-on\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Discuss on\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://twitter.com/SerCeMan/status/1448641518370103303\",\n          children: \"Twitter\"\n        })\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"title":"The Five Lies Analysis","description":"Empty","date":"2021-10-14"}},"frontMatter":{"title":"The Five Lies Analysis","description":"Empty","date":"2021-10-14"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"14-10-2021-the-five-lies-analysis"},"buildId":"vZVYDKMmC4lUxJF5StUtV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>